
@{
    ViewData["Title"] = "IndexHoteles";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<br>
<div id="frmHotelsReports" class="container ui segment">
 
    <div class="ui floating dropdown labeled search icon button" id="cbbCities">
            <i class="filter icon"></i>
            <span class="text">Filtrar por ciudad</span>
            <div class="menu">
                <div class="header">
                    <i class="tags icon"></i> Filter by tag
                </div>
                @foreach (CityListViewModel item in ViewBag.Ciudades)
                {
                    <div class="item" data-value="@item.ID">@item.Ciudad</div>

                }

                @*<div class="item" data-value="1">Choloma, Honduras</div>
                <div class="item" data-value="2">San pedro Sula, Honduras</div>
                <div class="item" data-value="3">Tegucigalpa, Honduras</div>*@
            </div>
        </div>

    <div class="ui floating dropdown labeled search icon button" id="cbbHotels">
        <i class="filter icon"></i>
        <span class="text">Filtrar por hotel</span>
        <div class="menu">
            <div class="header">
                <i class="tags icon"></i> Filter by tag
            </div>
            @foreach (HotelListViewModel item in ViewBag.Hoteles)
            {
                <div class="item" data-value="@item.ID">@item.Hotel</div>

            }
       
        </div>
    </div>

    <div class="ui floating dropdown labeled search icon button" id="cbbPartners">
        <i class="filter icon"></i>
        <span class="text">Filtrar por partner</span>
        <div class="menu">
            <div class="header">
                <i class="tags icon"></i> Filter by tag
            </div>
            @foreach (PartnersListViewModel item in ViewBag.Socios)
            {
                <div class="item" data-value="@item.ID">@item.Nombre</div>

            }
    
        </div>
    </div>
    <button class="ui positive button" onclick="REPORTS_FUNCTIONS.getReport_hotels(true)">FILTRAR REPORTE</button>
    <button class="ui positive button" onclick="REPORTS_FUNCTIONS.getReport_hotels(false)">TRAER TODOS</button>

    <div class="ui segment">
        <iframe id="ifrReport" src="" frameborder="0" width="100%" height="500px"></iframe>
    </div>

</div>



@section Scripts{

    <script>
        $(".ui.dropdown").dropdown();
    </script>



    <script>

        const REPORTS_FUNCTIONS = {

            getReport_hotels: function (parameter = false) {
                var query = {
                    parameters: {},
                    user_name: Client_User_Name
                };
              
                if (parameter) {

                    if ($("#cbbCities .item.selected").length > 0) {
                        var id_ciudad = $("#cbbCities .item.selected").attr("data-value");
                        query.parameters.ciudadID = parseInt(id_ciudad);
                    }
                    if ($("#cbbHotels .item.selected").length > 0) {
                        var id_hotel = $("#cbbHotels .item.selected").attr("data-value");
                        query.parameters.id = parseInt(id_hotel);
                    }
                    if ($("#cbbPartners .item.selected").length > 0) {
                        var id_socios = $("#cbbPartners .item.selected").attr("data-value");
                        query.parameters.iD_Partner = parseInt(id_socios);
                    }
                }
               

                $('#frmHotelsReports #ifrReport').attr('src', `https://totaltravelfileservices.yourgreatbusinesscenter.com/PDFs/Hotels_report_pdf.php?query=${JSON.stringify(query)}`);


            },

            
        }
        REPORTS_FUNCTIONS.getReport_hotels(false);
</script>



}