
@{
    ViewData["Title"] = "HotelesReport";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section CSS{
    <style>

        #a {
            margin: -3.150em .0em !important;
        }
    </style>
}


<h1>Reporte Hoteles</h1>
@try
{
    <div class="container-fluid">
        <div class="row">

            <!-- inicio columna contenedora -->
            <div class="col-10" style="margin: auto">
                <br>

                <div class="ui segment form">
                    <div class="fields two">
                        <div class="field">
                            <label>Escoge un filtro</label>
                            <select class="ui dropdown search" id="cbbFiltro">
                            </select>
                        </div>
                        <div class="field">
                            <label>Seleccione una opción</label>
                            <select class="ui dropdown search" id="cbbValor">
                                <option value="">Seleccione una opción</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="ui segment form">
                    <a href="@Url.Action("ExportPDF", "Report", new ReportCreationModel{DataSourceIndex= 2, HTMLFile = "HotelesReportHTML"} )" class="ui button icon">PDF <i class="file pdf icon"></i></a>
                    <a href="@Url.Action("HotelesReportXLS", "Report", new ReportCreationModel{DataSourceIndex= 2, HTMLFile = "HotelesReportXLS"} )" class="ui button icon">Excel <i class="file excel icon"></i> </a>

                </div>
                <br>
                <br>
                <div class="card">
                    <div class="card card-body" id="a">

                        <iframe src="" frameborder="0" height="650" id="ifrReport"></iframe>

                    </div>
                </div>
            </div>
            <!-- fin columna contenedora -->

        </div>
    </div>
}
catch (Exception)
{
<script>location.assign("@Url.Action("Error", "Home")");</script>}

@section HighlightTile{
    <script>

        $("#ReportModule").addClass("active");
        $("#ReportModule").addClass("expandedList");
        $("#ReportModule").prop("aria-expanded");
        $("#ReportModule").attr("aria-expanded", "true");

        $("#Report_Schema").addClass("show");

        $("#HotelReportTile").addClass("activeTile");
    </script>
}


@section Scripts{

    <script>
        const action = "HotelesReportPDF";
        const DataSourceIndex = 2;
        var HMTLFile = "TransportReportHTML";
    </script>

    <script src="~/js/Reports/HotelReports.js"></script>

    <script src="~/js/Reports/Reports.js"></script>
    <script>
        $(document).ready(function () {

            function fillIFrame(parameter) {
                //Recibir el array de bits del pdf
                $.ajax({
                    type: "POST",
                    url: "/Report/PdfAsByte",
                    data: parameter,
                    success: function (r) {
                        $("#ifrReport").attr("src", "data:application/pdf;base64," + r);
                    },
                    failure: function (response) {
                        alert(response.responseText);
                    },
                    error: function (response) {
                        alert(response.responseText);
                    }

                });
            }


            var reportParameter = reportCreation;
            reportParameter.ReportName = "HotelesPDF";
            reportParameter.HTMLFile = "HotelesReportHTML";
            reportParameter.DataSourceIndex = 2;
            fillIFrame(reportParameter);
        });
    </script>
}

